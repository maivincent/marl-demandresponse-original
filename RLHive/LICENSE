chrome.runtime.onMessage.addListener(function(a,d,e){switch(a.cmd){case "g_links":var b=[],h=/^(((ftp|https?):\/\/)|(data:)).+$/i,g={};a=function(a,d,e){if(a&&d)for(var c=0,k=a.length;c<k;++c){var f=a[c][d];h.test(f)&&void 0==g[f]&&(b.push({url:f,desc:a[c].download||"",text:e?a[c][e]||"":"",title:a[c].title||"",referer:""}),g[f]=1)}};a(document.links,"href","text");a(document.images,"src","alt");a(document.getElementsByTagName("audio"),"src");a(document.getElementsByTagName("video"),"src");a(document.getElementsByTagName("source"),
"src");a(document.getElementsByTagName("script"),"src");a(document.getElementsByTagName("link"),"href");0<b.length&&chrome.runtime.sendMessage({cmd:"add_links",data:b})}});
document.addEventListener("mousedown",function(a){function d(a){for(;a&&a.tagName;){if("a"==a.tagName.toLowerCase())return a;a=a.parentNode}return null}function e(a){for(;a;){if(a.src)return a;a=a.parentNode}return null}if(0<=a.button&&2>=a.button){var b=d(a.target);b&&b.href&&"j"!=b.href[0]&&chrome.runtime.sendMessage({cmd:"url_desc",url:b.href,download:(b.